# 真实动作与API映射完整分析

## 🎯 用户提供的真实遥控器动作 (26个)

### 🎭 表演动作 (9个)
| 中文 | 日语罗马音 | 对应API | API名称 | 状态需求 |
|------|-----------|---------|---------|----------|
| 翻身 | ゴロン(goron) | **1029** | Pounce/Rollover | 需站立 |
| 伸懒腰 | ノビ(nobi) | **1017** | Stretch | 需站立 |
| 握手 | お手(ote) | **1025** | ShakeHands | 需站立 |
| 比心 | ハート(haato) | **1021** | Wallow | 需站立 |
| 扑人 | トンデ(tonde) | **1029** | Pounce | 需站立 |
| 前跳 | ジャンプ(janpu) | **1028** | Jump | 需站立 |
| 拜年 | おじぎ(ojigi)/ちんちん | **1026/1030** | Cheer/Bow | 需站立 |
| 舞蹈1 | ダンス(kururin) | **1022** | Dance1 | 需站立 |
| 舞蹈2 | ダンス(dansu) | **1023** | Dance2 | 需站立 |

### 🏃 姿态控制 (5个)
| 中文 | 日语罗马音 | 对应API | API名称 | 状态需求 |
|------|-----------|---------|---------|----------|
| 阻尼 | スロー(surō) | **1001** | Damp | 任何状态 |
| 坐下 | おすわり(osuwari) | **1009** | Sit | 任何状态 |
| 摆姿势 | ポーズ(pōzu) | **1002** | BalanceStand | 需站立 |
| 站立 | タッテ(tatte) | **1004** | StandUp | 任何状态 |
| 常规 | ノーマル(nōmaru) | **1002** | BalanceStand | 任何状态 |

### 🏃 运动模式 (12个) 
| 中文 | 日语罗马音 | 对应API | API名称 | 参数需求 |
|------|-----------|---------|---------|----------|
| 灵动 | リズム(rizumu) | **1011** | SwitchGait | gait参数 |
| 跑步 | ハシレ(hashire) | **1008** | Move | speed参数 |
| 经典 | クラシック(kurashikku) | **1011** | SwitchGait | gait=0 |
| 锁定 | ロック(rokku) | **1003** | StopMove | - |
| 续航 | キープ(kīpu) | **1008** | Move | 持续参数 |
| 牵引 | ツイテ(tsuite) | **1008** | Move | follow模式 |
| 倒立 | サカダチ(sakadachi) | **特殊序列** | 多步骤 | 需权限 |
| 闪避 | カワセ(kawase) | **1008** | Move | 快速侧移 |
| 并腿跑 | ナカヨク(nakayoku) | **1011** | SwitchGait | gait=1 |
| 跳跃跑 | ジャンプラン(janpu ran) | **1011** | SwitchGait | gait=2 |
| 直立 | タッチ(tacchi) | **特殊序列** | 多步骤 | 需权限 |
| 交叉步 | クロス(kurosu) | **1011** | SwitchGait | gait=3 |

## 🔧 关键发现

### 1. **API映射必须明确**
LLM必须输出具体的API代码，而不是抽象的action_type！

### 2. **复杂动作需要序列化**
某些动作需要多个API调用序列：
- 倒立: StandUp(1004) → BalanceStand(1002) → 特殊序列
- 直立行走: StandUp(1004) → SwitchGait(1011, mode=bipedal)

### 3. **参数化动作处理**
许多动作需要参数：
- Move(1008): 需要速度、方向参数
- SwitchGait(1011): 需要步态参数
- BodyHeight(1013): 需要高度参数

## 💡 解决方案设计

### LLM输出格式建议
```json
{
  "response": "はい、座ります",     // TTS用简短回复
  "api_code": 1009,                  // 直接API代码！
  "params": {},                      // API参数（如需要）
  "sequence": [1004, 1009]          // 动作序列（如需要）
}
```

### 为什么这样设计？
1. **response**: 简短日语回复，直接用于TTS
2. **api_code**: 直接映射到SportClient方法，无需二次查找
3. **params**: 支持参数化动作
4. **sequence**: 支持复杂动作序列

## 🎯 3B模型优化方向

### 提示词设计原则
1. **极简**: 减少token使用，提高响应速度
2. **直接**: 输出API代码而非抽象类型
3. **结构化**: 严格JSON格式
4. **覆盖全面**: 包含所有26个真实动作

### 性能优化建议
- temperature: 0.0 (确定性输出)
- top_p: 0.5 (减少随机性)
- num_predict: 30 (足够输出JSON)
- num_ctx: 256 (包含必要上下文)
