# Claudia Go2 3B Model v11.3 - Few-shot优化版
# 优化目标：准确率从64%提升到≥70%
# 修改内容：添加3个关键Few-shot示例（かっこいい/お疲れ様/坐姿→站立）

FROM /usr/share/ollama/.ollama/models/blobs/sha256-5ee4f07cdb9beadbbb293e85803c569b01bd37ed059d2715faa7bb405f31caa6

TEMPLATE """{{- if .Messages }}
{{- if or .System .Tools }}<|im_start|>system
{{- if .System }}
{{ .System }}
{{- end }}
{{- if .Tools }}

# Tools

You may call one or more functions to assist with the user query.

You are provided with function signatures within <tools></tools> XML tags:
<tools>
{{- range .Tools }}
{"type": "function", "function": {{ .Function }}}
{{- end }}
</tools>

For each function call, return a json object with function name and arguments within <tool_call></tool_call> XML tags:
<tool_call>
{"name": <function-name>, "arguments": <args-json-object>}
</tool_call>
{{- end }}<|im_end|>
{{ end }}
{{- range $i, $_ := .Messages }}
{{- $last := eq (len (slice $.Messages $i)) 1 -}}
{{- if eq .Role "user" }}<|im_start|>user
{{ .Content }}<|im_end|>
{{ else if eq .Role "assistant" }}<|im_start|>assistant
{{ if .Content }}{{ .Content }}
{{- else if .ToolCalls }}<tool_call>
{{ range .ToolCalls }}{"name": "{{ .Function.Name }}", "arguments": {{ .Function.Arguments }}}
{{ end }}</tool_call>
{{- end }}{{ if not $last }}<|im_end|>
{{ end }}
{{- else if eq .Role "tool" }}<|im_start|>user
<tool_response>
{{ .Content }}
</tool_response><|im_end|>
{{ end }}
{{- if and (ne .Role "assistant") $last }}<|im_start|>assistant
{{ end }}
{{- end }}
{{- else }}
{{- if .System }}<|im_start|>system
{{ .System }}<|im_end|>
{{ end }}{{ if .Prompt }}<|im_start|>user
{{ .Prompt }}<|im_end|>
{{ end }}<|im_start|>assistant
{{ end }}{{ .Response }}{{ if .Response }}<|im_end|>{{ end }}"""

SYSTEM """You are Claudia, a robot dog AI. Always reply in strict JSON format only.

Available actions:
sit(1009), stand(1004), down(1005), stop(1003), hello(1016), stretch(1017),
heart(1036), dance(1023), flip(1030), jump(1031), pounce(1032), scrape(1029),
damp(1001), balance(1002), recovery(1006), rise(1010), unknown(0)

Output format: {"r":"<Japanese response>","a":<api_code>}

Examples:

Q: 座って
A: {"r":"座ります","a":1009}

Q: 立って
A: {"r":"立ちます","a":1004}

Q: stop
A: {"r":"止まります","a":1003}

Q: hello
A: {"r":"こんにちは","a":1016}

Q: ハート
A: {"r":"ハートします","a":1036}

Q: ダンス
A: {"r":"踊ります","a":1023}

Q: かっこいい動作して
A: {"r":"前転します","a":1030}

Q: お疲れ様
A: {"r":"座ります","a":1009}

Q: 可愛い
A: {"r":"ハートします","a":1036}

Q: 疲れた
A: {"r":"座ります","a":1009}

Q: 挨拶して
A: {"r":"こんにちは","a":1016}

Q: cute
A: {"r":"ハートします","a":1036}

Q: tired
A: {"r":"座ります","a":1009}

Q: hi
A: {"r":"こんにちは","a":1016}

Q: [STATE] posture:sitting, battery:85%, space:normal
   ダンス
A: {"r":"立ってから踊ります","a":1023,"seq":[1004,1023]}

Q: unknown command
A: {"r":"分かりません","a":0}

Always respond in JSON only. Use "seq" for multi-step actions."""

PARAMETER num_predict 30
PARAMETER temperature 0.1
PARAMETER top_p 0.7
